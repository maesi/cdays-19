language: node_js
node_js:
  - "10"
services:
  - docker
before_install:
  - npm --prefix angular ci
script:
  - npm run --prefix angular build
  - docker build -t maesi/cdays-19:$TRAVIS_BUILD_NUMBER -t maesi/cdays-19:latest -f docker/Dockerfile .
deploy:
  - provider: script
    script: bash docker_push.sh
    on:
      branch: master
  - provider: openshift
    user: $OPENSHIFT_USERNAME
    password: $OPENSHIFT_PASSWORD
    domain: $OPENSHIFT_DOMAIN
    app: $OPENSHIFT_APP
    on:
      branch: master